<!DOCTYPE html>
<html>
<head>
	<title>Round-Robin Algorithm<</title>

	<script type="text/javascript" src="lib/jquery.js"></script>
	<script type="text/javascript" src="lib/jquery.color.js"></script>
	<link rel="stylesheet" type="text/css" href="lib/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="lib/aos.css">
	<script type="text/javascript" src="lib/aos.js"></script>

<style type="text/css">
	body {
	    background: -webkit-linear-gradient(to left, #ECE9E6 , #FFFFFF); 
        background: linear-gradient(to left, #ECE9E6 , #FFFFFF);
	}

	td {
		text-align: center;
		vertical-align: middle;

	}

	img {
		width: 5%;
		margin-left: -30px;
	}


</style>

</head>
<body>

  <script>
    AOS.init({
    	duration: 1000
    });
  </script>

<br/><br/>
<div class="container">
<div data-aos="zoom-out-left">
<h1><a href="index.html"><img src="lib/icon.png" /></a> Round-robin Scheduling Algorithm</h1><br/><br/>
</div>	
<div data-aos="fade-left">
<strong>Enter number of program:</strong> 
<div class="row-lg-12">
<div class="col-lg-3">
<input type="" id="count" class="form-control">
</div></div>
<input type="button" id="ok" value="Show Programs" class="btn btn-warning">
<input type="button" value="RUN PROCESS" id="run" class="btn btn-danger"><br/>
<br/>
<p> <b>Programs</b> </p>
<span></span>
<br/><br/>
<table border="2" width="0" style="box-shadow: 10px 10px 20px black;">

</table>
</div>
<br/><br/><br/><br/>
<script type="text/javascript">
	
$("#ok").click(function(){


	// generate ng input box
	c = parseInt($("#count").val());

		$("span").prepend('<br/><div class="row-lg-12"><div data-aos="fade-left"><div class="container"><div class="col-lg-2"><strong>Quantum</strong></div><div class="col-lg-2"><input type="text" id="quantum" class="form-control"></div></div></div></div>');
	for (var i = 1; i <= c; i++){

		$("p").append('<br/><div class="row-lg-12"><div data-aos="fade-right"><div class="container"><div class="col-lg-2">Program ' + i + '-Bursttime</div><div class="col-lg-3"><input type="text" id="b'+i+'" class="form-control"></div></div></div></div>');
	}



});


$("#run").click(function(){

	var a = 0;
	var r = 0;
	var count = 0;
	var q = parseInt($("#quantum").val());

	console.log('quantum: '+ q);
	for (var i = 1; i <= c; i++) {

		a = parseInt($('#b'+i+'').val()) / q ;
/*		console.log('a'+i+':'+a);*/
		count += Math.floor(a);
		r = parseInt($('#b'+i+'').val()) % q;
/*		console.log('r'+i+':'+r);*/
		if (r != 0) {
			count++;
		}	
	}


	console.log('total td: ' +count);

	for (var i = 1; i <= count; i++) {
		$("table").append('<td id="td'+i+'" width="0%"></td>');
	}



	for(var i = 1; i <= count; i++) {

		parseInt($('#b'+i+'').val()) - q;
	}

	col = Array("#89070b","#d06960","#e8d568","#2bb1e0","#fea45d","#fd6c3d","#b9353a","#b86a30","#f4c685","#8c6f50","#6e6e71","#ffc296","#cbe6ea","#30688b","#476663","#8a0001","#d76001","#eacb86","#f1cbff","#c9c9ff","#ffbdbd","#e1f7d5","#d9d7d8","#bcd7cf","#f8dfca","#d6928b","#e8e1d7","#e9b481","#ea5c7d","#edbcc0","#e9b481","#d9d7d8","#bcd7cf","#f8dfca","#d6928b","#e8e1d7","#e9b481","#ea5c7d","#edbcc0","#e9b481");
	color="";
	

	arr = Array(50);
	temp = Array(50);
	sum = 0;
	val = 0;

	for (var i = 1; i <= c ; i++) {

		 $("#b"+i+"").each(function() { 
    	val += (parseInt($(this).val()));
 		});  

	}

	console.log('val:' + val);


	for (var i = 0; i <= count; i++) {
		arr[i] = new Array(50);
		temp[i] = new Array(50);
	}
	y = 0;
	x = val;
	for (var i = 0; i < count ; i++) {
		for (var j = 0; j < 1; j++) {
				color = col[Math.floor(Math.random() * col.length)];
				y = parseInt($('#b'+(i+1)+'').val());
				temp[i][0] = parseInt($('#b'+(i+1)+'').val());
				temp[i][1] = (i+1);
				temp[i][2] = color;
				temp[i][3] = 0;
				if (isNaN(temp[i][0])) {
					temp[i][0] = 0;
				}
				sum += temp[i][0];
		}

	}
	console.log('sum: ' + sum);
	bilang = 1;
	var diff = 0;

	inc = 0;
	while (sum != 0) {

			for (var i = 0; i < count ; i++) {

					if (temp[i][0] <= q) {
						console.log('val before'+i+':' +temp[i][0]);
						arr[i][0] = bilang;
						arr[i][1] = temp[i][0];
						arr[i][2] = temp[i][1];
						arr[i][3] = temp[i][2];
						arr[i][4] = Math.floor((temp[i][0]/x)*100);
						console.log('val after'+i+':' +arr[i][1]);
						bilang++;
						sum -= temp[i][0];
						temp[i][0] = 0;
						console.log('value nalang ng sum sa less than: '+sum);

					} else {
						console.log('val before'+i+':' +temp[i][0]);
						diff = temp[i][0] - q;
						arr[i][0] = bilang;
						arr[i][1] = q;
						arr[i][2] = temp[i][1];
						arr[i][3] = temp[i][2];
						arr[i][4] = Math.floor((q/x)*100);
						temp[(c+inc)][0] = diff;
						temp[(c+inc)][1] = temp[i][1];
						temp[(c+inc)][2] = temp[i][2];
						temp[(c+inc)][3] = Math.floor((diff/x)*100);
						bilang++;
						sum -= q;
						console.log('val after'+i+':' +arr[i][1]);
						console.log('value nalang ng sum: '+sum);
						console.log('c: ' + (c+inc));
						console.log('temp: '+ temp[(c+inc)][0]);
						inc++;

				}

			}
		
		sum = 0;
	}



			for (var i = 0; i < count ; i++) {
				for (var j = 0; j < 1; j++) {


					console.log('final value:'+i+'-->' + arr[i][1]); // burst
					console.log('program num:'+i+'-->' + arr[i][2]); // program number
					console.log('Color:'+i+'-->' + arr[i][3]); // color
					console.log('Percentage:'+i+'-->' + arr[i][4]); // percentage


				}

			}


	sum = 0;
	
	i = 1; // loop the animation

	myLoop();

	function myLoop(){

		setTimeout(function(){

	sum+=arr[i-1][1];
	$("#td"+i+"").replaceWith('<td style="background-color: '+arr[i-1][3]+'" height="100px" width="'+arr[i-1][4]+'%">P'+arr[i-1][2]+': Value: '+sum+'</td>');

	i++;

			if(i <= count) {
				myLoop();
			}

		},500)
	}		




});

	


</script>

</body>
</html>